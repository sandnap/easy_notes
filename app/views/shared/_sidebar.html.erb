<div class="flex flex-col">
  <div data-controller="dialog">
    <div class="flex">
      <button class="btn btn--primary grow mbe-4" 
            data-action="dialog#showModal"
            <%= 'disabled' unless authenticated? %>
            title="<%= authenticated? ? 'Add Category' : 'Please login to add categories' %>">
        Add Category
      </button>
    </div>
    <div id="dialog">
      <dialog class="dialog" data-dialog-target="menu" data-action="click->dialog#closeOnClickOutside">
        <%= render "shared/category_form", category: Category.new %>
      </dialog>
    </div>
  </div>

  <%= link_to categories_path, class: "btn btn--secondary mbe-8 text-center #{authenticated? ? '' : 'disabled'}", 
      title: authenticated? ? 'Edit Categories' : 'Please login to edit categories' do %>
    Edit Categories
  <% end %>

  <nav class="accordion" id="categories" data-controller="menu">
    <div class="categories_list menu__group">
      <%= render partial: "categories/category", collection: @categories %>
    </div>
  </nav>

  <% @categories.each do |category| %>
    <div class="category">
      <h3 class="font-semibold pbs-2"><%= category.name %></h3>
      <div class="notes_list" data-controller="sortable" data-parent-id="<%= category.id %>" data-sortable-handle-value=".handle">
        <% category.notes.each do |note| %>
          <%= tag.div class: "flex items-center gap border p-3", data: { url_value: category_note_path(category, note) } do %>
            <%= image_tag "menu.svg", class: "colorize-black handle", size: 16 %>
            <span><%= note.title %></span>
          <% end %>
        <% end %>
      </div>
    </div>
  <% end %>
</div>
